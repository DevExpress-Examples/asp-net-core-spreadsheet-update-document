using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using DevExpress.AspNetCore.Spreadsheet;
using DevExpress.Spreadsheet;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using Newtonsoft.Json;
using UpdateDocumentUsingAJAX.Models;
using DevExpress.Spreadsheet;
using System.IO;
using System.Drawing;

namespace UpdateDocumentUsingAJAX.Controllers {
    public class HomeController : Controller {
        private readonly ILogger<HomeController> _logger;
        private const string ByteArray1 = "[80,75,3,4,20,0,6,0,8,0,0,0,33,0,98,238,157,104,94,1,0,0,144,4,0,0,19,0,8,2,91,67,111,110,116,101,110,116,95,84,121,112,101,115,93,46,120,109,108,32,162,4,2,40,160,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,148,203,78,195,48,16,69,247,72,252,67,228,45,74,220,178,64,8,53,237,130,199,18,42,81,62,192,196,147,198,170,99,91,158,105,105,255,158,137,251,16,66,161,21,106,55,177,18,207,220,123,50,241,205,104,178,110,109,182,130,136,198,187,82,12,139,129,200,192,85,94,27,55,47,197,199,236,37,191,23,25,146,114,90,89,239,160,20,27,64,49,25,95,95,141,102,155,0,152,113,183,195,82,52,68,225,65,74,172,26,104,21,22,62,128,227,157,218,199,86,17,223,198,185,12,170,90,168,57,200,219,193,224,78,86,222,17,56,202,169,211,16,227,209,19,212,106,105,41,123,94,243,227,45,73,4,139,34,123,220,22,118,94,165,80,33,88,83,41,98,82,185,114,250,151,75,190,115,40,184,51,213,96,99,2,222,48,134,144,189,14,221,206,223,6,187,190,55,30,77,52,26,178,169,138,244,170,90,198,144,107,43,191,124,92,124,122,191,40,142,139,244,80,250,186,54,21,104,95,45,91,158,64,129,33,130,210,216,0,80,107,139,180,22,173,50,110,207,125,196,63,21,163,76,203,240,194,32,221,251,37,225,19,28,196,223,27,100,186,158,143,144,100,78,24,34,109,44,224,165,199,158,68,79,57,55,42,130,126,167,200,201,184,56,192,79,237,99,28,124,110,166,209,7,228,4,69,248,255,20,246,17,233,186,243,192,66,16,201,192,33,36,125,135,237,224,200,233,59,123,236,208,229,91,131,238,241,150,233,127,50,254,6,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,181,85,48,35,244,0,0,0,76,2,0,0,11,0,8,2,95,114,101,108,115,47,46,114,101,108,115,32,162,4,2,40,160,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,146,77,79,195,48,12,134,239,72,252,135,200,247,213,221,144,16,66,75,119,65,72,187,33,84,126,128,73,220,15,181,141,163,36,27,221,191,39,28,16,84,26,131,3,71,127,189,126,252,202,219,221,60,141,234,200,33,246,226,52,172,139,18,20,59,35,182,119,173,134,151,250,113,117,7,42,38,114,150,70,113,172,225,196,17,118,213,245,213,246,153,71,74,121,40,118,189,143,42,171,184,168,161,75,201,223,35,70,211,241,68,177,16,207,46,87,26,9,19,165,28,134,22,61,153,129,90,198,77,89,222,98,248,174,1,213,66,83,237,173,134,176,183,55,160,234,147,207,155,127,215,150,166,233,13,63,136,57,76,236,210,153,21,200,115,98,103,217,174,124,200,108,33,245,249,26,85,83,104,57,105,176,98,158,114,58,34,121,95,100,108,192,243,68,155,191,19,253,124,45,78,156,200,82,34,52,18,248,50,207,71,199,37,160,245,127,90,180,52,241,203,157,121,196,55,9,195,171,200,240,201,130,139,31,168,222,1,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,210,155,197,125,217,2,0,0,185,6,0,0,15,0,0,0,120,108,47,119,111,114,107,98,111,111,107,46,120,109,108,172,85,93,111,155,48,20,125,159,180,255,128,252,78,177,249,74,130,74,170,230,163,90,164,109,138,186,126,188,68,170,28,112,130,21,192,204,118,154,84,85,255,251,174,33,36,77,179,135,174,29,74,108,204,133,227,115,238,61,92,206,47,182,69,110,61,50,169,184,40,99,68,206,48,178,88,153,136,148,151,203,24,221,222,92,217,93,100,41,77,203,148,230,162,100,49,122,98,10,93,244,191,126,57,223,8,185,154,11,177,178,0,160,84,49,202,180,174,34,199,81,73,198,10,170,206,68,197,74,136,44,132,44,168,134,165,92,58,170,146,140,166,42,99,76,23,185,227,98,28,58,5,229,37,106,16,34,249,30,12,177,88,240,132,141,68,178,46,88,169,27,16,201,114,170,129,190,202,120,165,90,180,34,121,15,92,65,229,106,93,217,137,40,42,128,152,243,156,235,167,26,20,89,69,18,77,150,165,144,116,158,131,236,45,9,172,173,132,95,8,127,130,97,112,219,157,32,116,178,85,193,19,41,148,88,232,51,128,118,26,210,39,250,9,118,8,57,74,193,246,52,7,239,67,242,29,201,30,185,169,225,158,149,12,63,200,42,220,99,133,7,48,130,63,141,70,192,90,181,87,34,72,222,7,209,130,61,55,23,245,207,23,60,103,119,141,117,45,90,85,63,105,97,42,149,35,43,167,74,143,83,174,89,26,163,14,44,197,134,29,46,128,42,185,174,6,107,158,67,212,245,92,143,32,167,191,183,243,84,194,2,106,127,153,107,38,75,170,217,80,148,26,172,182,163,254,89,91,213,216,195,76,128,137,173,107,246,123,205,37,131,119,7,44,4,114,96,164,73,68,231,106,74,117,102,173,101,30,163,97,52,187,85,160,112,182,144,44,101,179,214,247,106,166,89,81,205,94,57,144,158,218,253,31,60,72,19,147,2,7,100,55,212,154,243,183,41,0,134,50,106,125,54,213,210,130,243,201,232,59,228,250,23,125,132,204,67,125,211,221,139,57,129,212,18,239,161,76,100,68,30,158,187,161,239,15,177,139,109,236,5,196,246,135,129,103,247,194,224,202,38,151,174,135,131,78,167,55,240,188,23,16,35,195,40,17,116,173,179,93,81,13,116,140,252,224,47,161,31,116,219,70,8,142,214,60,61,208,120,198,187,195,54,243,155,161,141,189,24,193,166,125,221,113,182,81,135,242,155,165,181,189,231,101,42,54,49,178,137,11,162,158,142,151,155,58,120,207,83,157,129,127,122,216,135,91,154,107,223,24,95,102,192,152,4,174,91,147,118,13,179,24,29,49,26,53,140,174,224,176,205,112,196,200,121,69,169,110,148,64,173,158,173,178,54,247,13,248,24,250,177,105,161,117,138,193,202,145,217,65,78,210,218,197,78,251,80,66,243,100,42,45,51,213,55,134,110,143,120,70,51,219,234,239,74,215,51,88,140,3,57,226,227,203,14,238,249,54,30,123,129,237,119,123,174,221,245,61,215,30,250,35,119,28,116,198,163,241,32,48,213,49,109,62,250,31,205,174,118,122,212,126,63,12,203,140,74,125,35,105,178,130,175,206,53,91,12,168,2,59,53,130,128,47,184,177,101,237,180,79,245,255,0,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,129,62,148,151,243,0,0,0,186,2,0,0,26,0,8,1,120,108,47,95,114,101,108,115,47,119,111,114,107,98,111,111,107,46,120,109,108,46,114,101,108,115,32,162,4,1,40,160,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,82,77,75,196,48,16,189,11,254,135,48,119,155,118,21,17,217,116,47,34,236,85,235,15,8,201,180,41,219,38,33,51,126,244,223,27,42,186,93,88,214,75,47,3,111,134,121,239,205,199,118,247,53,14,226,3,19,245,193,43,168,138,18,4,122,19,108,239,59,5,111,205,243,205,3,8,98,237,173,30,130,71,5,19,18,236,234,235,171,237,11,14,154,115,19,185,62,146,200,44,158,20,56,230,248,40,37,25,135,163,166,34,68,244,185,210,134,52,106,206,48,117,50,106,115,208,29,202,77,89,222,203,180,228,128,250,132,83,236,173,130,180,183,183,32,154,41,102,229,255,185,67,219,246,6,159,130,121,31,209,243,25,9,73,60,13,121,0,209,232,212,33,43,248,193,69,246,8,242,188,252,102,77,121,206,107,193,163,250,12,229,28,171,75,30,170,53,61,124,134,116,32,135,200,71,31,127,41,146,115,229,162,153,187,85,239,225,116,66,251,202,41,191,219,242,44,203,244,239,102,228,201,199,213,223,0,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,80,179,76,68,24,2,0,0,98,5,0,0,24,0,0,0,120,108,47,119,111,114,107,115,104,101,101,116,115,47,115,104,101,101,116,49,46,120,109,108,156,148,219,142,155,48,16,134,239,43,245,29,144,239,131,129,156,118,17,176,82,26,173,186,23,149,170,158,238,29,51,128,21,140,169,237,156,84,245,221,59,134,66,86,77,42,37,139,56,216,48,124,255,140,255,129,228,233,40,107,111,15,218,8,213,164,36,244,3,226,65,195,85,46,154,50,37,223,191,61,79,30,136,103,44,107,114,86,171,6,82,114,2,67,158,178,247,239,146,131,210,91,83,1,88,15,9,141,73,73,101,109,27,83,106,120,5,146,25,95,181,208,224,147,66,105,201,44,78,117,73,77,171,129,229,221,75,178,166,81,16,44,168,100,162,33,61,33,214,183,48,84,81,8,14,107,197,119,18,26,219,67,52,212,204,98,254,166,18,173,25,104,146,223,130,147,76,111,119,237,132,43,217,34,98,35,106,97,79,29,148,120,146,199,47,101,163,52,219,212,88,247,49,156,49,238,29,53,238,17,30,211,65,166,187,127,161,36,5,215,202,168,194,250,72,166,125,206,151,229,63,210,71,202,248,72,186,172,255,38,76,56,163,26,246,194,25,120,70,69,111,75,41,156,143,172,232,12,155,190,17,182,24,97,110,185,116,188,19,121,74,126,5,127,183,9,94,67,119,10,206,167,225,217,111,146,37,185,64,135,93,85,158,134,34,37,171,105,188,90,18,154,37,93,255,252,16,112,48,175,198,158,101,155,175,80,3,183,128,26,33,241,92,123,110,148,218,186,192,23,188,21,32,209,116,1,142,200,184,21,123,248,0,117,141,96,215,225,63,123,141,7,39,64,71,133,215,227,65,237,185,107,232,207,218,203,161,96,187,218,126,81,135,143,32,202,202,162,236,28,203,116,125,18,231,167,53,24,142,13,138,194,126,52,31,211,94,51,203,178,68,171,131,135,102,227,162,152,150,185,79,39,138,221,106,95,125,51,75,184,139,93,97,48,194,12,86,177,207,130,132,238,49,53,142,7,162,70,222,236,30,30,6,143,188,240,58,15,171,185,61,191,121,151,217,127,72,139,123,72,139,142,20,93,207,105,121,15,105,217,145,166,255,144,122,123,123,39,90,86,194,39,166,75,209,24,175,134,162,179,11,37,116,239,103,224,227,216,170,214,153,184,196,213,216,40,107,149,28,102,21,254,203,0,173,9,124,244,166,80,202,14,19,215,66,227,223,49,251,3,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,77,63,128,44,132,6,0,0,128,26,0,0,19,0,0,0,120,108,47,116,104,101,109,101,47,116,104,101,109,101,49,46,120,109,108,236,89,207,111,219,54,20,190,15,216,255,32,232,238,90,182,37,217,14,234,20,182,108,39,107,147,182,104,220,14,61,210,54,109,177,161,68,67,164,147,26,69,129,93,119,25,48,160,27,118,25,176,219,14,195,128,2,219,105,151,253,55,45,182,238,143,216,35,37,91,100,76,55,253,145,2,221,208,24,8,36,234,123,143,31,223,123,250,248,67,215,111,60,78,168,115,134,51,78,88,218,113,107,215,60,215,193,233,132,77,73,58,239,184,247,71,195,74,203,117,184,64,233,20,81,150,226,142,187,194,220,189,177,255,249,103,215,209,158,136,113,130,29,176,79,249,30,234,184,177,16,139,189,106,149,79,160,25,241,107,108,129,83,120,54,99,89,130,4,220,102,243,234,52,67,231,224,55,161,213,186,231,133,213,4,145,212,117,82,148,128,219,59,179,25,153,96,103,36,93,186,251,107,231,3,10,183,169,224,178,97,66,179,19,233,26,27,22,10,59,61,173,73,4,95,241,136,102,206,25,162,29,23,250,153,178,243,17,126,44,92,135,34,46,224,65,199,245,212,159,91,221,191,94,69,123,133,17,21,59,108,53,187,161,250,43,236,10,131,233,105,93,245,153,205,199,155,78,125,63,240,195,238,198,191,2,80,177,141,27,52,7,225,32,220,248,83,0,52,153,192,72,115,46,186,207,160,215,238,245,131,2,171,129,242,75,139,239,126,179,223,168,25,120,205,127,99,139,115,55,144,63,3,175,64,185,127,127,11,63,28,70,16,69,3,175,64,57,62,176,196,164,89,143,124,3,175,64,57,62,220,194,55,189,110,223,111,26,120,5,138,41,73,79,183,208,94,16,54,162,245,104,55,144,25,163,135,86,120,59,240,135,205,122,225,188,68,65,53,108,170,75,118,49,99,169,216,85,107,9,122,196,178,33,0,36,144,34,65,82,71,172,22,120,134,38,80,197,17,162,100,156,17,231,136,204,99,40,188,5,74,25,135,102,175,238,13,189,6,252,151,63,95,93,169,136,160,61,140,52,107,201,11,152,240,173,38,201,199,225,147,140,44,68,199,189,9,94,93,13,242,112,233,28,48,17,147,73,209,171,114,98,88,28,162,116,174,91,188,250,249,219,127,126,252,202,249,251,183,159,94,61,251,46,239,244,34,158,235,248,151,191,126,253,242,143,63,95,231,30,198,90,6,225,197,247,207,95,254,254,252,197,15,223,252,245,203,51,139,247,110,134,198,58,124,68,18,204,157,219,248,220,185,199,18,24,154,133,63,30,103,111,103,49,138,17,49,44,80,12,190,45,174,7,16,56,29,120,123,133,168,13,215,195,102,8,31,100,160,47,54,224,193,242,145,193,245,36,206,150,130,88,122,190,21,39,6,240,152,49,218,99,153,53,0,183,100,95,90,132,71,203,116,110,239,60,91,234,184,123,8,157,217,250,142,80,106,36,120,176,92,128,176,18,155,203,40,198,6,205,187,20,165,2,205,113,138,133,35,159,177,83,140,45,163,123,72,136,17,215,99,50,201,24,103,51,225,60,36,78,15,17,107,72,70,100,108,20,82,105,116,72,18,200,203,202,70,16,82,109,196,230,248,129,211,99,212,54,234,62,62,51,145,240,90,32,106,33,63,194,212,8,227,1,90,10,148,216,92,142,80,66,245,128,31,33,17,219,72,158,172,178,137,142,27,112,1,153,158,99,202,156,193,20,115,110,179,185,147,193,120,181,164,223,2,109,177,167,253,152,174,18,19,153,9,114,106,243,121,132,24,211,145,125,118,26,197,40,89,88,57,147,52,214,177,95,240,83,40,81,228,220,101,194,6,63,102,230,27,34,239,33,15,40,221,153,238,7,4,27,233,190,92,8,238,131,172,234,148,202,2,145,79,150,153,37,151,7,152,153,239,227,138,206,16,86,42,3,170,111,136,121,66,210,75,149,253,130,166,7,31,90,211,237,234,124,5,106,110,119,252,62,58,222,205,136,245,109,58,188,160,222,187,112,255,65,205,238,163,101,122,23,195,107,178,61,103,125,146,236,79,146,237,254,239,37,123,215,187,124,245,66,93,106,51,200,118,185,62,87,171,245,100,231,98,125,70,40,61,17,43,138,143,184,90,175,115,152,145,166,67,104,84,27,9,181,155,220,108,222,22,49,92,22,91,3,3,55,207,144,178,113,50,38,190,36,34,62,137,209,2,22,245,53,181,245,156,243,194,245,156,59,11,198,97,173,175,154,213,38,24,95,240,173,118,12,203,228,152,77,243,61,106,173,38,247,163,185,120,112,36,202,118,47,216,180,195,254,66,228,232,176,89,238,187,54,238,213,78,118,174,246,199,107,2,210,246,109,72,104,157,153,36,26,22,18,205,117,35,100,225,117,36,212,200,174,132,69,219,194,162,37,221,175,83,181,206,226,38,20,64,109,147,21,88,50,57,176,208,234,184,129,159,239,253,97,27,133,40,158,202,60,229,199,0,235,236,202,228,92,105,166,119,5,147,234,21,0,235,135,117,5,148,153,110,75,174,59,135,39,71,151,151,218,27,100,218,32,161,149,155,73,66,43,195,24,77,113,81,157,250,97,201,85,230,186,93,166,212,160,39,67,177,126,27,74,26,205,214,135,200,181,20,145,11,218,64,83,93,41,104,234,156,119,220,176,17,192,121,216,4,45,58,238,12,246,250,112,153,44,160,118,184,92,234,34,58,135,3,179,137,200,242,23,254,93,148,101,145,113,209,71,60,206,3,174,68,39,87,131,132,8,156,57,148,36,29,87,14,127,83,13,52,85,26,162,184,213,234,32,8,31,45,185,54,200,202,199,70,14,146,110,38,25,207,102,120,34,244,180,107,45,50,210,249,45,40,124,174,21,214,167,202,252,221,193,210,146,45,33,221,39,241,244,220,25,211,101,118,15,65,137,5,205,154,12,224,148,112,56,242,169,229,209,156,18,56,195,220,8,89,89,127,23,38,166,66,118,245,67,68,85,67,121,59,162,139,24,21,51,138,46,230,57,92,137,232,134,142,186,219,196,64,187,43,198,12,1,221,14,225,120,46,39,216,247,158,117,47,159,170,101,228,52,209,44,231,76,67,85,228,172,105,23,211,15,55,201,107,172,202,73,212,96,149,75,183,218,54,240,82,235,218,107,173,131,66,181,206,18,151,204,186,111,48,33,104,212,202,206,12,106,146,241,182,12,75,205,46,90,77,106,87,184,32,208,34,17,238,136,219,102,142,176,70,226,93,103,126,176,187,88,181,114,130,88,175,43,85,225,171,143,29,250,247,8,54,126,4,226,209,135,147,223,37,21,92,165,18,190,54,100,8,22,125,249,217,113,46,27,240,138,60,22,197,26,17,174,156,101,70,58,238,19,47,232,250,81,61,136,42,94,43,24,84,252,134,239,85,90,65,183,81,233,6,65,163,54,8,106,94,191,87,127,10,19,139,136,147,90,144,127,104,25,194,17,20,93,21,159,91,84,251,214,39,151,100,125,202,118,109,194,146,42,83,159,84,170,138,184,250,228,82,171,239,254,228,226,16,16,157,39,97,125,216,110,180,123,97,165,221,232,14,43,126,191,215,170,180,163,176,87,233,135,81,179,63,236,71,65,171,61,124,234,58,103,10,236,119,27,145,31,14,90,149,176,22,69,21,63,244,36,253,86,187,210,244,235,245,174,223,236,182,6,126,247,105,177,140,129,145,231,242,81,196,2,194,171,120,237,255,11,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,121,161,128,108,164,2,0,0,82,6,0,0,13,0,0,0,120,108,47,115,116,121,108,101,115,46,120,109,108,164,85,109,107,219,48,16,254,62,216,127,16,250,238,202,118,227,44,9,182,203,210,212,80,232,198,160,29,236,171,98,203,137,168,94,140,36,103,206,198,254,251,78,118,94,28,58,182,209,126,137,78,231,211,115,207,221,115,82,210,155,78,10,180,99,198,114,173,50,28,93,133,24,49,85,234,138,171,77,134,191,62,21,193,12,35,235,168,170,168,208,138,101,120,207,44,190,201,223,191,75,173,219,11,246,184,101,204,33,128,80,54,195,91,231,154,5,33,182,220,50,73,237,149,110,152,130,47,181,54,146,58,216,154,13,177,141,97,180,178,254,144,20,36,14,195,41,145,148,43,60,32,44,100,249,63,32,146,154,231,182,9,74,45,27,234,248,154,11,238,246,61,22,70,178,92,220,111,148,54,116,45,128,106,23,77,104,137,186,104,106,98,212,153,99,146,222,251,34,143,228,165,209,86,215,238,10,112,137,174,107,94,178,151,116,231,100,78,104,121,70,2,228,215,33,69,9,9,227,139,218,59,243,74,164,9,49,108,199,189,124,56,79,107,173,156,69,165,110,149,3,49,129,168,111,193,226,89,233,239,170,240,159,188,115,136,202,83,251,3,237,168,0,79,132,73,158,150,90,104,131,28,72,7,157,235,61,138,74,54,68,220,82,193,215,134,251,176,154,74,46,246,131,59,246,142,94,237,67,156,228,208,123,239,36,158,199,97,177,112,136,11,113,98,21,123,2,224,200,83,144,207,49,163,10,216,160,131,253,180,111,32,189,130,73,27,96,250,184,127,68,111,12,221,71,113,50,58,64,250,132,121,186,214,166,130,201,62,247,227,232,202,83,193,106,7,68,13,223,108,253,234,116,3,191,107,237,28,168,159,167,21,167,27,173,168,240,165,12,32,39,3,202,41,153,16,143,126,250,191,213,23,216,93,141,84,43,11,233,238,171,12,195,61,242,77,56,154,80,200,193,28,240,134,141,199,31,163,13,216,111,134,69,93,125,137,15,136,35,218,23,164,79,233,145,215,59,195,159,253,117,21,48,57,7,8,180,110,185,112,92,253,129,48,96,86,221,185,5,161,87,192,249,171,215,55,231,148,5,58,81,177,154,182,194,61,157,62,102,248,108,127,98,21,111,101,124,138,250,194,119,218,245,16,25,62,219,15,94,169,104,234,115,176,206,61,88,24,47,88,81,107,120,134,127,222,45,63,204,87,119,69,28,204,194,229,44,152,92,179,36,152,39,203,85,144,76,110,151,171,85,49,15,227,240,246,215,232,1,120,195,245,239,223,171,60,133,139,181,176,2,30,9,115,40,246,80,226,227,217,151,225,209,102,160,223,207,40,208,30,115,159,199,211,240,99,18,133,65,113,29,70,193,100,74,103,193,108,122,157,4,69,18,197,171,233,100,121,151,20,201,136,123,242,202,103,34,36,81,52,60,56,158,124,178,112,92,50,193,213,81,171,163,66,99,47,136,4,219,191,20,65,142,74,144,243,159,65,254,27,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,70,42,198,126,163,0,0,0,208,0,0,0,20,0,0,0,120,108,47,115,104,97,114,101,100,83,116,114,105,110,103,115,46,120,109,108,84,142,65,10,194,48,16,69,247,130,119,8,179,183,105,187,16,145,36,93,20,60,129,30,32,180,163,13,52,147,154,153,138,222,222,184,16,113,249,222,231,193,55,221,51,206,234,129,153,67,34,11,77,85,131,66,26,210,24,232,102,225,114,62,237,14,160,88,60,141,126,78,132,22,94,200,208,185,237,198,48,139,42,45,177,133,73,100,57,106,205,195,132,209,115,149,22,164,178,92,83,142,94,10,230,155,230,37,163,31,121,66,148,56,235,182,174,247,58,250,64,160,134,180,146,88,104,65,173,20,238,43,246,95,118,134,131,51,226,250,68,130,36,141,209,226,140,254,184,63,223,254,188,46,143,220,27,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,25,70,49,145,75,1,0,0,107,2,0,0,17,0,8,1,100,111,99,80,114,111,112,115,47,99,111,114,101,46,120,109,108,32,162,4,1,40,160,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,124,146,81,75,195,48,20,133,223,5,255,67,201,123,155,164,115,99,43,109,7,83,246,228,64,176,162,248,22,146,187,173,216,164,33,201,236,246,239,77,219,173,86,39,62,38,231,220,47,231,92,146,46,143,178,10,62,193,216,178,86,25,162,17,65,1,40,94,139,82,237,50,244,82,172,195,57,10,172,99,74,176,170,86,144,161,19,88,180,204,111,111,82,174,19,94,27,120,50,181,6,227,74,176,129,39,41,155,112,157,161,189,115,58,193,216,242,61,72,102,35,239,80,94,220,214,70,50,231,143,102,135,53,227,31,108,7,56,38,100,134,37,56,38,152,99,184,5,134,122,32,162,51,82,240,1,169,15,166,234,0,130,99,168,64,130,114,22,211,136,226,111,175,3,35,237,159,3,157,50,114,202,210,157,180,239,116,142,59,102,11,222,139,131,251,104,203,193,216,52,77,212,76,186,24,62,63,197,111,155,199,231,174,106,88,170,118,87,28,80,158,10,158,112,3,204,213,38,95,27,16,96,74,30,172,12,28,82,60,82,218,45,86,204,186,141,95,248,182,4,177,58,253,54,95,27,60,185,43,210,227,65,4,62,90,210,23,185,40,175,147,251,135,98,141,242,152,208,105,72,102,33,153,22,116,158,208,69,50,185,123,111,223,255,49,223,70,237,47,228,57,197,191,196,152,132,148,132,113,92,144,69,75,164,100,68,188,0,242,20,95,125,143,252,11,0,0,255,255,3,0,80,75,3,4,20,0,6,0,8,0,0,0,33,0,173,16,241,215,135,1,0,0,15,3,0,0,16,0,8,1,100,111,99,80,114,111,112,115,47,97,112,112,46,120,109,108,32,162,4,1,40,160,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,156,146,205,110,219,48,16,132,239,5,250,14,2,239,49,229,180,8,10,131,98,80,56,45,114,104,81,3,86,210,51,75,173,44,34,20,73,112,55,130,221,167,239,74,66,28,185,233,169,183,253,25,12,63,14,169,110,143,189,47,6,200,232,98,168,196,122,85,138,2,130,141,141,11,135,74,60,212,95,175,62,137,2,201,132,198,248,24,160,18,39,64,113,171,223,191,83,187,28,19,100,114,128,5,91,4,172,68,71,148,54,82,162,237,160,55,184,226,117,224,77,27,115,111,136,219,124,144,177,109,157,133,187,104,159,123,8,36,175,203,242,70,194,145,32,52,208,92,165,179,161,152,29,55,3,253,175,105,19,237,200,135,143,245,41,49,176,86,159,83,242,206,26,226,91,234,239,206,230,136,177,165,226,203,209,130,87,114,185,84,76,183,7,251,156,29,157,116,169,228,178,85,123,107,60,108,217,88,183,198,35,40,249,58,80,247,96,198,208,118,198,101,212,106,160,205,0,150,98,46,208,253,230,216,174,69,241,203,32,140,56,149,24,76,118,38,16,99,141,178,185,153,106,159,144,178,254,25,243,19,118,0,132,74,178,96,30,78,229,82,187,172,221,71,189,158,4,92,92,10,71,131,25,132,23,151,136,181,35,15,248,163,221,153,76,255,32,94,47,137,39,134,153,119,198,169,1,233,13,221,116,97,62,231,47,231,109,236,147,9,39,94,156,171,111,46,60,225,67,170,227,157,33,120,9,243,114,168,246,157,201,208,112,254,231,176,207,3,117,207,57,102,63,154,108,59,19,14,208,188,104,222,46,198,167,127,156,255,183,94,223,172,202,15,37,191,234,98,166,228,235,79,214,127,0,0,0,255,255,3,0,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,98,238,157,104,94,1,0,0,144,4,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,91,67,111,110,116,101,110,116,95,84,121,112,101,115,93,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,181,85,48,35,244,0,0,0,76,2,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,151,3,0,0,95,114,101,108,115,47,46,114,101,108,115,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,210,155,197,125,217,2,0,0,185,6,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,188,6,0,0,120,108,47,119,111,114,107,98,111,111,107,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,129,62,148,151,243,0,0,0,186,2,0,0,26,0,0,0,0,0,0,0,0,0,0,0,0,0,194,9,0,0,120,108,47,95,114,101,108,115,47,119,111,114,107,98,111,111,107,46,120,109,108,46,114,101,108,115,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,80,179,76,68,24,2,0,0,98,5,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,245,11,0,0,120,108,47,119,111,114,107,115,104,101,101,116,115,47,115,104,101,101,116,49,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,77,63,128,44,132,6,0,0,128,26,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,67,14,0,0,120,108,47,116,104,101,109,101,47,116,104,101,109,101,49,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,121,161,128,108,164,2,0,0,82,6,0,0,13,0,0,0,0,0,0,0,0,0,0,0,0,0,248,20,0,0,120,108,47,115,116,121,108,101,115,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,70,42,198,126,163,0,0,0,208,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,199,23,0,0,120,108,47,115,104,97,114,101,100,83,116,114,105,110,103,115,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,25,70,49,145,75,1,0,0,107,2,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,156,24,0,0,100,111,99,80,114,111,112,115,47,99,111,114,101,46,120,109,108,80,75,1,2,45,0,20,0,6,0,8,0,0,0,33,0,173,16,241,215,135,1,0,0,15,3,0,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,30,27,0,0,100,111,99,80,114,111,112,115,47,97,112,112,46,120,109,108,80,75,5,6,0,0,0,0,10,0,10,0,128,2,0,0,219,29,0,0,0,0]";
        private const string DocumentId1 = "MyDocumentId1";
        public HomeController(ILogger<HomeController> logger) {
            _logger = logger;
        }

        public IActionResult Index() {
            byte[] byteArrayAccessor() => JsonConvert.DeserializeObject<byte[]>(ByteArray1);
            var model = new SpreadsheetDocumentContent(DocumentId1, byteArrayAccessor);
            return View(model);
        }

        public IActionResult Privacy() {
            return View();
        }

        [ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
        public IActionResult Error() {
            return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
        }
        [HttpPost]
        [HttpGet]
        public IActionResult DxDocRequest() {
            return SpreadsheetRequestProcessor.GetResponse(HttpContext);
        }      

        public void FillInDocument(Worksheet worksheet)
        {
            string[] Expenses = new string[8] { "Expenses", "Benefits", "Marketing events", "Office lease",
            "Security", "Training classes", "Web site hosting", "Web site updates"};            
            Row fistRow = worksheet.Rows[0];
            fistRow.ColumnWidthInCharacters = 6;
            fistRow.Alignment.Horizontal = SpreadsheetHorizontalAlignment.Center;
            fistRow.Font.Size = 12;
            fistRow.Font.FontStyle = SpreadsheetFontStyle.Bold;
            Column fistColumn = worksheet.Columns[0];
            fistColumn.ColumnWidthInCharacters = 17;
            fistColumn.Font.Size = 12;            
            CellCollection cells = worksheet.Cells;
            for(int i =0; i<12; i++) {
                cells[0,i+1].Value = DateTime.Now.AddYears(i).Year.ToString();
                cells[0, i + 1].Font.Color = Color.White;
            }
            for (int i = 0; i < 8; i++) {
                cells[i, 0].Value = Expenses[i];
            }
            CellRange range = worksheet.Range["A1:M8"];
            DevExpress.Spreadsheet.Formatting rangeFormatting = range.BeginUpdateFormatting();
            rangeFormatting.Fill.BackgroundColor = Color.DarkGray;
            rangeFormatting.Borders.InsideHorizontalBorders.LineStyle = BorderLineStyle.Thin;
            rangeFormatting.Borders.InsideHorizontalBorders.Color = Color.Gray;
            rangeFormatting.Borders.InsideVerticalBorders.LineStyle = BorderLineStyle.Thin;
            rangeFormatting.Borders.InsideVerticalBorders.Color = Color.Gray;
            rangeFormatting.Borders.SetOutsideBorders(Color.Black, BorderLineStyle.Thick);
            range.EndUpdateFormatting(rangeFormatting);
        }
        public ActionResult NewDocument(SpreadsheetClientState spreadsheetState) {
            var spreadsheet = SpreadsheetRequestProcessor.GetSpreadsheetFromState(spreadsheetState);
            spreadsheet.New();
            FillInDocument(spreadsheet.Document.Worksheets[0]);
            byte[] docBytes = spreadsheet.SaveCopy(DocumentFormat.Xlsx);
            Func<byte[]> contentAccessor = () => docBytes;
            var model = new SpreadsheetDocumentContent(Guid.NewGuid().ToString(), contentAccessor);
            return PartialView("SpreadsheetPartialView", model);
        }
    }
}
